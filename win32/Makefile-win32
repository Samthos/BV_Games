SRC=main.cpp sdl_help.cpp menu.cpp pugixml.cpp game.cpp player.cpp ball.cpp
OBJ=${SRC:.cpp=.o}
OBJ_win32=${SRC:.cpp=_win32.o}

CWD=$(shell pwd)

CXX=g++
CXX_FLAGS=-std=c++11 -O3 -ggdb
INC=
LIB=-lSDL2 -lSDL2_ttf

CXX_win32=i686-w64-mingw32-g++-win32
CXX_FLAGS_win32=-std=c++11 -O3 -DSDL_MAIN_HANDLED
INC_win32=-I${CWD}/include 
LIB_win32=-static-libgcc -static-libstdc++ -L${CWD}/win32 ${LIB}

all: pong.x #pong_win32.exe
	#cp pong_win32.exe lib

pong.x: ${OBJ}
	${CXX} ${CXX_FLAGS} -o $@ $^ ${LIB}

%.o: %.cpp 
	${CXX} ${CXX_FLAGS} -c $< ${INC}

pong_win32.exe: ${OBJ_win32}
	${CXX_win32} ${CXX_FLAGS_win32} -o $@ $^ ${LIB_win32}

%_win32.o: %.cpp 
	${CXX_win32} ${CXX_FLAGS_win32} -c -o $@ $< ${INC_win32}

val:
	valgrind --tool=memcheck --leak-check=full --track-origins=yes ./pong.x
clean:
	rm *.o *.x *.exe
